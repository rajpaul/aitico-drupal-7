<div class="schedule-view">
    <h2><?php print t('Scheduled file updates'); ?>: 
        <span class="blue"><?php print t($company_title); ?> - <?php print t($site_title); ?> - <?php print t($cst_title); ?></span></h2>
    <label class="select-group" for="group-select"><?php print t('Select group'); ?></label>       
    <select id="group-select">
        <?php if (isset($group_lists)): ?>

            <?php            
            $initial_group = array_shift(array_values($group_lists));
            $initial_group_id = $initial_group->nid;
            $slot_number = count(get_all_slot_of_a_group($initial_group_id));
            ?>
            <?php foreach ($group_lists as $group): ?>
                <option value="<?php print $group->nid; ?>"><?php print t($group->title); ?></option>
            <?php endforeach; ?>
    <?php endif; ?>
    </select>
    <?php foreach ($group_lists as $group): ?>
        <a style="display:none;" id="update_cst_group_<?php print $group->nid; ?>" href="/administration/schedule/group-view/<?php print $group->nid; ?>" class="use-ajax"></a>
        <a style="display:none;" id="add_schedule_update_<?php print $group->nid; ?>" href="/administration/schedule/add/<?php print $group->nid; ?>" class="use-ajax"></a>
    <?php endforeach; ?>
    <table class="table table-bordered table-hover" id="schedule-table">
        <thead>
            <tr>
                <th class="span4"><?php print t('Date of the update'); ?></th>
                <?php for ($i = 1; $i <= $slot_number; $i++): ?>
                <th><?php print t('Slot ') . $i; ?></th>
                <?php endfor; ?>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($schedule_info as $key => $val): ?>
                <tr id="<?php print $key;?>">
                    <?php
                    list($date, $time) = explode('|', date('m/d/Y|H:i', $val['schedule_time']));
                    ?>
                    <td><input id="schedule-date" type="text" class="input-small" value="<?php print $date; ?>"/><div class="bootstrap-timepicker"><input id="schedule-time" type="text" class="input-small" value="<?php print $time; ?>"/></div></td>
                    <?php foreach ($val['files_info'] as $row): ?>
                        <td> <?php
                        $file_schedule_id = $key;
                        $file_slot_id = $row->parent_slot_id;
                        $file_slot_node = node_load($file_slot_id);
                        $slot_file_type = $file_slot_node->field_file_type['und'][0]['value'];
                        $file_node = get_files_node($file_slot_id, FILE_TYPE_CODE_SCHEDULE, $file_schedule_id);
                        $files_form = get_aitico_node_form('files', $file_slot_id, $file_node);
                        $form = render($files_form);
                        print $form;
                        ?>
                        </td>
                    <?php endforeach; ?>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
    <?php print l(t('Remove selected update'), "administration/schedule/remove/678", array('attributes' => array('class' => 'btn btn-grey'))); ?>
        <div class="btn btn-primary" id="add_schedule_update"><?php print t("Add scheduled update"); ?></div>
</div><!--/log-->
